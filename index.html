<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="AlignDiff: Aligning Diverse Human Preferences via Behavior-customisable Diffusion Model">
  <!-- <meta name="keywords" content="Nerfies, D-NeRF, NeRF"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AlignDiff: Aligning Diverse Human Preferences via Behavior-customisable Diffusion Model</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script> -->
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">AlignDiff: Aligning Diverse Human Preferences via Behavior-customisable Diffusion Model</h1>
          <div class="is-size-5 publication-authors">
            <!-- <span class="author-block">
              <a href="https://keunhong.com">Keunhong Park</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://utkarshsinha.com">Utkarsh Sinha</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://jonbarron.info">Jonathan T. Barron</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="http://sofienbouaziz.com">Sofien Bouaziz</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.danbgoldman.com">Dan B Goldman</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://homes.cs.washington.edu/~seitz/">Steven M. Seitz</a><sup>1,2</sup>,
            </span>
            <span class="author-block">
              <a href="http://www.ricardomartinbrualla.com">Ricardo Martin-Brualla</a><sup>2</sup>
            </span>
          </div> -->
<!-- 
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Washington,</span>
            <span class="author-block"><sup>2</sup>Google Research</span>
          </div> -->

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>

              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/aligndiff/aligndiff.github.io"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Nerfies</span> turns selfie videos from your phone into
        free-viewpoint
        portraits.
      </h2>
    </div>
  </div>
</section>


<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Aligning agent behaviors with diverse human preferences remains a challenging problem in reinforcement learning (RL), 
            owing to the inherent <i>abstractness</i> and <i>mutability</i> of human preferences. To address these issues, 
            we propose <b>AlignDiff</b>, a novel framework that leverages RL from Human Feedback (RLHF) to quantify human preferences, 
            covering <i>abstractness</i>, and utilizes them to guide diffusion planning for zero-shot behavior customizing, covering 
            <i>mutability</i>. AlignDiff can accurately match user-customized behaviors and efficiently switch from one to another. 
            To build the framework, we first establish the multi-perspective human feedback datasets, which contain comparisons for 
            the attributes of diverse behaviors, and then train an attribute strength model to predict quantified relative strengths. 
            After relabeling behavioral datasets with relative strengths, we proceed to train an attribute-conditioned diffusion model, 
            which serves as a planner with the attribute strength model as a director for preference aligning at the inference phase. 
            We evaluate AlignDiff on various locomotion tasks and demonstrate its superior performance on preference matching, switching, 
            and covering compared to other baselines. Its capability of completing unseen downstream tasks under human instructions also 
            showcases the promising potential for human-AI collaboration. More visualization videos are released on 
            <a href="https://aligndiff.github.io/">https://aligndiff.github.io/</a>.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
    <hr style="border-top: 5px dotted #b8b8b8;">
    <!-- Method. -->
    <!-- <div class="columns"> 
      <div class="column is-10 is-offset-1">  -->
    <h2 class="title is-3">Method</h2> 
    <div style="display: flex; margin: auto; justify-content: center; width: 100%"> 
      <img style="width: 100%" src="./static/images/AlignDiff_main.svg"/> 
    </div> 
    <div class="content has-text-justified" style="margin-top: 20px;"> 
      <p class="caption"><br /> 
        <strong>Overview of AlignDiff.</strong> AlignDiff leverages RLHF to quantify human preferences and 
        utilizes them to guide diffusion planning for zero-shot behavior customizing. Firstly, 
        we collect multi-perspective human feedback through crowdsourcing. Secondly, we use this 
        feedback to train an attribute strength model, which we then use to relabel the behavioral 
        datasets. Thirdly, we train a diffusion model on the annotated datasets, which can understand 
        and generate trajectories with various attributes. Lastly, we can use AlignDiff for inference, 
        aligning agent behaviors with human preferences at any time. 
      </p> 
    </div> 
      <!-- </div> 
    </div> -->
    <!--/ Method. -->
    <hr style="border-top: 5px dotted #b8b8b8;">
    <h2 class="title is-3">Results</h2> 
    <!--/ Hopper. -->
    <h3 class="title is-4">Matching performance</h3>
    <p> In each video, starting from the same initial state, 
      a specific attribute is set to three different levels, <strong>0.1, 0.5, and 0.9</strong> (increasing from left to right). 
      The video on the left is produced by <strong>AlignDiff</strong>, while the video on the right is produced by the <strong>baseline</strong> method.</p> 
    
    <br>
    <p> <strong>Hopper - Jump height</strong> - A larger value indicates a higher jumping height. 
      AlignDiff exhibits a significant disparity in jump heights across three levels, while the baseline shows an insignificant 
      difference in heights and exhibits peculiar jumping postures.</p>
    <div style="height:10px;"></div>
    <div class="columns is-centered">
      <div class="column is-6"> <div class="content">
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/hopper_ad_1_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>AlignDiff</strong> </figcaption> </div>
      </div>
      <div class="column is-6"> <div class="columns is-centered"> <div class="column content">
          <video id="matting-video" controls playsinline height="100%">
            <source src="./static/videos/hopper_bl_1_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>Baseline</strong> </figcaption> </div> </div>
      </div>
    </div>
    <!--/ Hopper. -->

    <!--/ Walker1. -->
    <p> <strong>Walker - Leg preference</strong> - A larger value indicates a preference for using the left leg, 
      while a smaller value indicates a preference for using the right leg. 
      A middle value indicates normal walking with both legs. AlignDiff demonstrates a clear preference for utilizing the left 
      and right legs differently. In the left video, it relies on the right leg for walking, while in the middle video, 
      it employs both legs simultaneously. In the right video, it relies on the left leg for walking. However, 
      the baseline does not exhibit any behavioral variation in this regard.</p>
    <div style="height:10px;"></div>
    <div class="columns is-centered">
      <div class="column is-6"> <div class="content">
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/walker_ad_2_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>AlignDiff</strong> </figcaption> </div>
      </div>
      <div class="column is-6"> <div class="columns is-centered"> <div class="column content">
          <video id="matting-video" controls playsinline height="100%">
            <source src="./static/videos/walker_bl_2_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>Baseline</strong> </figcaption></div> </div>
      </div>
    </div>
    <!--/ Walker1. -->

    <!--/ Walker2. -->
    <p> <strong>Walker - Torso height</strong> - A larger value indicates a higher torso height. AlignDiff rapidly 
      adjusts its behavior and exhibits noticeable differences in torso height. However, the baseline, although eventually showing 
      height disparities as well, takes a significantly longer time to adapt its behavior.</p>
    <div style="height:10px;"></div>
    <div class="columns is-centered">
      <div class="column is-6"> <div class="content">
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/walker_ad_3_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>AlignDiff</strong> </figcaption> </div>
      </div>
      <div class="column is-6"> <div class="columns is-centered"> <div class="column content">
          <video id="matting-video" controls playsinline height="100%">
            <source src="./static/videos/walker_bl_3_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>Baseline</strong> </figcaption> </div> </div>
      </div>
    </div>
    <!--/ Walker2. -->

    <!--/ Humanoid. -->
    <p> <strong>Humanoid - Speed</strong> - A larger value indicates a faster movement speed. AlignDiff demonstrates 
      significant differences in speed, while the baseline is unable to even perform the locomotion behavior.</p>
    <div style="height:10px;"></div>
    <div class="columns is-centered">
      <div class="column is-6"> <div class="content">
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/humanoid_ad_0_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>AlignDiff</strong> </figcaption> </div>
      </div>
      <div class="column is-6"> <div class="columns is-centered"> <div class="column content">
          <video id="matting-video" controls playsinline height="100%">
            <source src="./static/videos/humanoid_bl_0_cap.mp4" type="video/mp4">
          </video> <figcaption style="text-align:center;"> <strong>Baseline</strong> </figcaption> </div> </div>
      </div>
    </div>
    <!--/ Humanoid. -->

    <p> We also conduct a quantitative evaluation of the matching performance. 
      The performance scores of various algorithms are presented in the table below, where higher scores indicate stronger 
      preference aligning capabilities. The establishment of quantitative metrics and the method of obtaining table data are 
      described in the experimental section of the paper.</p>
    <div style="height:10px;"></div>
    <div style="display: flex; margin: auto; justify-content: center; width: 90%"> 
      <img style="width: 100%" src="./static/images/matching_table.png"/> 
    </div>
    <div style="height:40px;"></div>

    <h3 class="title is-4">Switching performance</h3>
    <p> In the video, we adjust the preference 
      for the speed attribute every 200 steps and visualize the tracking curve of the 
      target attribute (ground truth). The video on the left is produced by AlignDiff, 
      while the video on the right is produced by the baseline method. 
      AlignDiff is able to track the ground truth more quickly and accurately.</p> 
    <br>
    <div class="content has-text-centered">
      <video id="replay-video"
             controls
             muted
             preload
             playsinline
             width="75%">
        <source src="./static/videos/switch_cap.mp4"
                type="video/mp4">
      </video>
    </div>

    <p> We further test AlignDiff's zero-shot capability under human instructions by 
      deploying it to unseen downstream tasks. By adjusting attributes such as speed, 
      torso height, and stride length by the human instructor, the walker robot, which 
      was only trained on locomotion datasets, successfully complete the gap-crossing and obstacle avoidance tasks</p> 
    <br>
    <div class="columns is-centered">
      <div class="column is-4">
        <img style="width: 100%" src="./static/images/switch.png"/>  </div>
      <div class="column is-4"> <div class="content has-text-centered">
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/gap_cap.mp4" type="video/mp4">
          </video> </div>
      </div>
      <div class="column is-4"> <div class="columns is-centered"> <div class="column content has-text-left">
          <video id="matting-video" controls playsinline height="100%">
            <source src="./static/videos/limbo_cap.mp4" type="video/mp4">
          </video> </div> </div>
      </div>
    </div>

    <div style="height:20px;"></div>
    <h3 class="title is-4">Covering performance</h3>
    <div style="display: flex; margin: auto; justify-content: center; width: 100%"> 
      <img style="width: 100%" src="./static/images/dist.png"/> 
    </div>
    <div class="content has-text-justified" style="margin-top: 20px;"> 
      <p class="caption"><br /> 
        Covering distribution of AlignDiff and other baselines trained with human labels. 
        The x-axis represents relative attribute strength, and the y-axis represents 
        the corresponding actual attribute. The points (x, y) in the highlighted 
        region indicate that the algorithm is more likely to produce trajectories 
        with the actual attribute y given x as a condition. Comparing to the ground 
        truth (dataset distribution), AlignDiff is able to better cover the dataset 
        distribution and produce behaviors that are not present in the dataset 
        (intuitively, it can fill the gaps in the disconnected regions within the highlighted area).
      </p> 
    </div> 

    <div style="height:20px;"></div>
    <h3 class="title is-4">Human evaluation</h3>
    <div style="display: flex; margin: auto; justify-content: center; width: 90%"> 
      <img style="width: 100%" src="./static/images/humaneval.png"/> 
    </div>
    <div class="content has-text-justified" style="margin-top: 20px;"> 
      <p class="caption"><br /> 
        Results of human evaluation. We invite human evaluators to assess the behaviors 
        produced by the algorithm, with higher scores indicating stronger alignment with 
        human preferences. AlignDiff outperforms other baselines significantly. For detailed 
        information on the human evaluation, please refer to the experimental section of the paper.
      </p> 
    </div> 

    <hr style="border-top: 5px dotted #b8b8b8;">
    <h3 class="title is-4">Released behavioral & human feedback datasets</h3>
    <style>
      table {
        border-collapse: collapse;
        width: 100%;
      }
      td, th {
        border: 1px solid #dddddd;
        text-align: center ;
        padding: 8px;
      }
      tr:first-child {
        background-color: #bbc4dd;
        color: rgb(255, 255, 255);
        text-align: center;
        font-size: 16px;
      }
      tr {
        background-color: white;
        color: black;
        text-align: center;
        font-size: 14px;
      }
      </style>
      
      <table>
        <tr>
          <th>Domain</th>
          <th>Transitions</th>
          <th>Feedbacks</th>
          <th>Size(Behavioral datasets/Feedback datasets)</th>
          <th>Link</th>
        </tr>
        <tr>
          <td>Hopper</td>
          <td>5M</td>
          <td>1228</td>
          <td>324M/42.7M</td>
          <td><a href="">Download</a></td>
        </tr>
        <tr>
          <td>Walker</td>
          <td>3.2M</td>
          <td>4000</td>
          <td>1.19G/91.6M</td>
          <td><a href="">Download</a></td>
        </tr>
        <tr>
          <td>Humanoid</td>
          <td>2.5M</td>
          <td>4000</td>
          <td>4.11G/875M</td>
          <td><a href="">Download</a></td>
        </tr>
      </table>

</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/aligndiff/aligndiff.github.io" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/aligndiff/aligndiff.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
